<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Designing a Set of Tables for User Login in · MySQL 101 - Beginner's Guide to Learning MySQL</title><meta name="description" content="Designing a Set of Tables for User Login in - onlytiancai"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mysql101.com/atom.xml" title="MySQL 101 - Beginner's Guide to Learning MySQL"><script async src="https://www.googletagmanager.com/gtag/js?id=G-FTL5JTLX07"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FTL5JTLX07');</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="MySQL 101 - Beginner's Guide to Learning MySQL" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Designing a Set of Tables for User Login in</h1><div class="post-info">Jan 9, 2025</div><div class="post-content"><p>Designing a robust and scalable user login system is a critical component of many applications. In this blog, we’ll explore how to design a set of MySQL tables for managing user login functionality and important SQL queries to interact with these tables effectively.</p>
<span id="more"></span>
<hr>
<h4 id="1-Key-Components-of-the-Database-Design"><a class="header-anchor" href="#1-Key-Components-of-the-Database-Design">¶</a>1. Key Components of the Database Design</h4>
<p>The design will include the following tables:</p>
<ol>
<li><strong>Users Table</strong>: Stores user information.</li>
<li><strong>Login Logs Table</strong>: Tracks login attempts and details.</li>
<li><strong>Roles and Permissions Tables</strong> (Optional): Implements role-based access control (RBAC).</li>
</ol>
<p>Let’s break these down one by one.</p>
<hr>
<h3 id="Users-Table"><a class="header-anchor" href="#Users-Table">¶</a>Users Table</h3>
<p>The <code>users</code> table stores basic user details such as usernames, hashed passwords, and contact information.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    user_id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- Unique user ID</span></span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,   <span class="comment">-- Username</span></span><br><span class="line">    password_hash <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,    <span class="comment">-- Encrypted password</span></span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span>,              <span class="comment">-- Email address</span></span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">15</span>),                      <span class="comment">-- Phone number (optional)</span></span><br><span class="line">    is_active <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">TRUE</span>,         <span class="comment">-- Account activation status</span></span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>, <span class="comment">-- Account creation time</span></span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="comment">-- Last updated time</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Login-Logs-Table"><a class="header-anchor" href="#Login-Logs-Table">¶</a>Login Logs Table</h3>
<p>The <code>login_logs</code> table records each login attempt, capturing details like IP address, device, and whether the login was successful.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> login_logs (</span><br><span class="line">    log_id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,  <span class="comment">-- Unique log ID</span></span><br><span class="line">    user_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                   <span class="comment">-- User ID (foreign key)</span></span><br><span class="line">    login_time <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>, <span class="comment">-- Time of login</span></span><br><span class="line">    ip_address <span class="type">VARCHAR</span>(<span class="number">45</span>),                 <span class="comment">-- IP address (supports IPv4 and IPv6)</span></span><br><span class="line">    device_info <span class="type">VARCHAR</span>(<span class="number">255</span>),               <span class="comment">-- Information about the device used</span></span><br><span class="line">    success <span class="type">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">TRUE</span>,           <span class="comment">-- Whether the login was successful</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (user_id) <span class="keyword">REFERENCES</span> users(user_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Roles-and-Permissions-Tables-Optional"><a class="header-anchor" href="#Roles-and-Permissions-Tables-Optional">¶</a>Roles and Permissions Tables (Optional)</h3>
<p>If your application requires role-based access control, include the following tables:</p>
<h4 id="Roles-Table"><a class="header-anchor" href="#Roles-Table">¶</a>Roles Table</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> roles (</span><br><span class="line">    role_id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- Unique role ID</span></span><br><span class="line">    role_name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,  <span class="comment">-- Role name (e.g., Admin, User)</span></span><br><span class="line">    description <span class="type">VARCHAR</span>(<span class="number">255</span>)                <span class="comment">-- Description of the role</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="User-Roles-Table-Mapping-Users-to-Roles"><a class="header-anchor" href="#User-Roles-Table-Mapping-Users-to-Roles">¶</a>User Roles Table (Mapping Users to Roles)</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user_roles (</span><br><span class="line">    user_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,       <span class="comment">-- User ID</span></span><br><span class="line">    role_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,       <span class="comment">-- Role ID</span></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (user_id, role_id),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (user_id) <span class="keyword">REFERENCES</span> users(user_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (role_id) <span class="keyword">REFERENCES</span> roles(role_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="Permissions-Table"><a class="header-anchor" href="#Permissions-Table">¶</a>Permissions Table</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> permissions (</span><br><span class="line">    permission_id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- Unique permission ID</span></span><br><span class="line">    permission_name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">-- Permission name</span></span><br><span class="line">    description <span class="type">VARCHAR</span>(<span class="number">255</span>)                      <span class="comment">-- Description of the permission</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="Role-Permissions-Table-Mapping-Roles-to-Permissions"><a class="header-anchor" href="#Role-Permissions-Table-Mapping-Roles-to-Permissions">¶</a>Role Permissions Table (Mapping Roles to Permissions)</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> role_permissions (</span><br><span class="line">    role_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,          <span class="comment">-- Role ID</span></span><br><span class="line">    permission_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,    <span class="comment">-- Permission ID</span></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (role_id, permission_id),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (role_id) <span class="keyword">REFERENCES</span> roles(role_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (permission_id) <span class="keyword">REFERENCES</span> permissions(permission_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="2-Important-SQL-Queries"><a class="header-anchor" href="#2-Important-SQL-Queries">¶</a>2. Important SQL Queries</h4>
<h5 id="1-Insert-a-New-User"><a class="header-anchor" href="#1-Insert-a-New-User">¶</a>1. Insert a New User</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (username, password_hash, email, phone)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;john_doe&#x27;</span>, <span class="string">&#x27;hashed_password_here&#x27;</span>, <span class="string">&#x27;john@example.com&#x27;</span>, <span class="string">&#x27;1234567890&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h5 id="2-Record-a-Login-Attempt"><a class="header-anchor" href="#2-Record-a-Login-Attempt">¶</a>2. Record a Login Attempt</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> login_logs (user_id, ip_address, device_info, success)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;192.168.1.1&#x27;</span>, <span class="string">&#x27;Chrome on Windows 10&#x27;</span>, <span class="literal">TRUE</span>);</span><br></pre></td></tr></table></figure>
<h5 id="3-Fetch-Login-History-for-a-User"><a class="header-anchor" href="#3-Fetch-Login-History-for-a-User">¶</a>3. Fetch Login History for a User</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> login_time, ip_address, device_info, success</span><br><span class="line"><span class="keyword">FROM</span> login_logs</span><br><span class="line"><span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> login_time <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
<h5 id="4-Assign-a-Role-to-a-User"><a class="header-anchor" href="#4-Assign-a-Role-to-a-User">¶</a>4. Assign a Role to a User</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> user_roles (user_id, role_id)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">2</span>); <span class="comment">-- Assign role_id 2 to user_id 1</span></span><br></pre></td></tr></table></figure>
<h5 id="5-Check-User-Permissions"><a class="header-anchor" href="#5-Check-User-Permissions">¶</a>5. Check User Permissions</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p.permission_name</span><br><span class="line"><span class="keyword">FROM</span> permissions p</span><br><span class="line"><span class="keyword">JOIN</span> role_permissions rp <span class="keyword">ON</span> p.permission_id <span class="operator">=</span> rp.permission_id</span><br><span class="line"><span class="keyword">JOIN</span> user_roles ur <span class="keyword">ON</span> rp.role_id <span class="operator">=</span> ur.role_id</span><br><span class="line"><span class="keyword">WHERE</span> ur.user_id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="3-Best-Practices"><a class="header-anchor" href="#3-Best-Practices">¶</a>3. Best Practices</h4>
<ul>
<li><strong>Password Security</strong>: Always store passwords as hashed values using strong algorithms like bcrypt.</li>
<li><strong>Indexes</strong>: Add indexes on frequently queried fields like <code>username</code> and <code>user_id</code>.</li>
<li><strong>Foreign Key Constraints</strong>: Use foreign key constraints to ensure data integrity between related tables.</li>
<li><strong>Logging</strong>: Regularly monitor and archive login logs to maintain database performance.</li>
<li><strong>Scalability</strong>: Consider sharding or partitioning large tables (e.g., <code>login_logs</code>) for better performance in high-traffic systems.</li>
</ul>
<hr>
<p>By following this design and using the provided queries, you can implement a secure and efficient user login system that scales with your application’s needs. Happy coding!</p>
</div></article></div></main><footer><div class="paginator"><a href="/mysql-tutorial/2025/01/09/Designing-a-Message-Queue-Using-MySQL/" class="prev">PREV</a><a href="/mysql-tutorial/2024/12/17/hello-world/" class="next">NEXT</a></div><div class="copyright"><p>© 2024 - 2025 <a href="https://mysql101.com">onlytiancai</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div></body></html>